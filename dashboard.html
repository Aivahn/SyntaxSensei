<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SyntaxSensei - Java Learning Platform</title>

    <style>
        * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    }

    html {
      background: white;
    }

    body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, #0f1419 0%, #1a1f2e 50%, #252a3d 100%);
    color: white;
    min-height: 100vh;
    }

    .container {
    display: flex;
    min-height: 100vh;
    }

    .avatar-initial {
    width: 48px;
    height: 48px;
    background-color: #4a90e2;
    border-radius: 50%;
    color: white;
    font-weight: bold;
    font-size: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    }

    .avatar-initial-small {
    background-color: #4a90e2;
    color: white;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    font-size: 16px;
    }

    .avatar-small img.icon-small {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    }

    /* Icon styling */
    .icon {
    width: 18px;
    height: 18px;
    display: inline-block;
    margin-right: 8px;
    }

    #logo-icon {
    width: 46px;
    height: 36px;
    }

    .icon-large {
    width: 20px;
    height: 20px;
    }

    .icon-small {
    width: 12px;
    height: 12px;
    }

    hr {
    margin-bottom: 10px;
    margin-top: 8px;
    }

    .menu-item {
    margin-left: 20px;
    font-weight: bold;
    font-size: 20px;
    }

    .social-icon {
    width: 25px;
    display: inline-block;
    }

    /* Mobile Header */
    .mobile-header {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 60px;
    background: rgba(15, 20, 25, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    z-index: 1000;
    padding: 0 15px;
    align-items: center;
    justify-content: space-between;
    }

    .mobile-burger {
    width: 30px;
    height: 30px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    cursor: pointer;
    padding: 5px;
    position: relative;
    z-index: 1101;
    }

    .burger-line {
    width: 20px;
    height: 2px;
    background: white;
    margin: 2px 0;
    transition: all 0.3s ease;
    border-radius: 1px;
    }

    .mobile-burger.active .burger-line:nth-child(1) {
    transform: rotate(45deg) translate(5px, 5px);
    }

    .mobile-burger.active .burger-line:nth-child(2) {
    opacity: 0;
    }

    .mobile-burger.active .burger-line:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -6px);
    }

    .mobile-logo {
    display: flex;
    align-items: center;
    font-size: 16px;
    font-weight: 600;
    }

    .mobile-user {
    display: flex;
    align-items: center;
    cursor: pointer;
    gap: 8px;
    }

    .mobile-user-avatar {
    width: 28px;
    height: 28px;
    background: #2d5587;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    }

    .user-arrow {
    font-size: 10px;
    transition: transform 0.3s ease;
    }

    .user-arrow.active {
    transform: rotate(180deg);
    }

    #desktopUser.active .user-arrow {
    transform: rotate(180deg);
    }

    /* Mobile Sidebar Overlay */
    .sidebar-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
    }

    .sidebar-overlay.active {
    display: block;
    }

    /* User Dropdown - Updated for both mobile and desktop */
    .user-dropdown {
    position: fixed;
    top: 60px;
    right: 15px;
    width: 200px;
    background: rgba(15, 20, 25, 0.95);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 15px;
    transform: translateY(-10px);
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 1001;
    }

    .user-dropdown.active {
    transform: translateY(0);
    opacity: 1;
    visibility: visible;
    }

    /* Desktop user dropdown positioning */
    @media (min-width: 769px) {
    .user-dropdown {
    top: 70px;
    right: 30px;
    }
    }

    .user-info {
    text-align: center;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    margin-bottom: 15px;
    }

    .user-info .avatar {
    width: 50px;
    height: 50px;
    background: #2d5587;
    border-radius: 50%;
    margin: 0 auto 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    }

    .user-info h3 {
    font-size: 14px;
    margin-bottom: 4px;
    }

    .user-info p {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.7);
    }

    .dropdown-item {
    display: block;
    width: 100%;
    padding: 10px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    color: white;
    text-decoration: none;
    font-size: 12px;
    margin-bottom: 8px;
    cursor: pointer;
    transition: background 0.2s;
    }

    .dropdown-item:hover {
    background: rgba(255, 255, 255, 0.1);
    }

    .dropdown-item:last-child {
    margin-bottom: 0;
    }

    /* Sidebar */
    .sidebar {
    width: 240px;
    background: rgba(15, 20, 25, 0.9);
    padding: 20px 0; /* Default tighter padding for desktop */
    border-right: 1px solid rgba(255, 255, 255, 0.05);
    transition: transform 0.3s ease;
    z-index: 1000;
    }


    .logo {
    display: flex;
    align-items: center;
    padding: 0 20px 30px;
    font-size: 18px;
    font-weight: 600;
    }

    .nav-menu {
    list-style: none;
    }

    .nav-item {
    padding: 12px 20px;
    cursor: pointer;
    transition: background 0.2s;
    display: flex;
    align-items: center;
    font-size: 14px;
    }

    .nav-item:hover {
    background: rgba(255, 255, 255, 0.05);
    }

    .nav-item.active {
    background: rgba(45, 85, 135, 0.3);
    border-right: 3px solid #2d5587;
    }

    /* Main Content */
    .main-content {
    flex: 1;
    padding: 20px 30px;
    overflow-y: auto;
    }

    /* Header */
    .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    }

    .search-container {
    position: relative;
    flex: 1;
    max-width: 400px;
    margin: 0 20px;
    }

    .search-input {
    width: 100%;
    padding: 10px 40px 10px 15px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 25px;
    color: white;
    font-size: 14px;
    }

    .search-input::placeholder {
    color: rgba(255, 255, 255, 0.4);
    }

    .search-btn {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.4);
    cursor: pointer;
    width: 20px;
    height: 20px;
    }

    .user-menu {
    display: flex;
    align-items: center;
    gap: 15px;
    cursor: pointer;
    }

    .user-avatar {
    width: 32px;
    height: 32px;
    background: #2d5587;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: 600;
    }

    /* Welcome Section */
    .welcome-section {
    margin-bottom: 30px;
    margin-top: 30px;
    }

    .welcome-title {
    font-size: 24px;
    font-weight: 600;
    margin-bottom: 20px;
    }

    .welcome-buttons {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
    }

    .btn {
    padding: 12px 24px;
    border: none;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 8px;
    }

    .btn-primary {
    background: #2d5587;
    color: white;
    }

    .btn-primary:hover {
    background: #1e3a5f;
    }

    .btn-secondary {
    background: rgba(255, 255, 255, 0.05);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .btn-secondary:hover {
    background: rgba(255, 255, 255, 0.1);
    }

    /* Learning Progress */
    .section {
    margin-bottom: 30px;
    }

    .section-title {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 15px;
    }

    .progress-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 15px;
    margin-bottom: 15px;
    }

    .progress-card {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 20px;
    position: relative;
    }

    .progress-card h3 {
    font-size: 16px;
    margin-bottom: 8px;
    font-weight: 500;
    }

    .progress-bar {
    width: 100%;
    height: 6px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 3px;
    overflow: hidden;
    margin-bottom: 10px;
    }

    .progress-fill {
    height: 100%;
    background: #4a90e2;
    border-radius: 3px;
    transition: width 0.3s ease;
    }

    .progress-card:nth-child(1) .progress-fill { width: 45%; }
    .progress-card:nth-child(2) .progress-fill { width: 20%; }
    .progress-card:nth-child(3) .progress-fill { width: 10%; }

    .continue-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(74, 144, 226, 0.2);
    color: #4a90e2;
    border: 1px solid #4a90e2;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 12px;
    cursor: pointer;
    margin-top: 10px;
    }

    /* Recommended Topics */
    .topics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
    }

    .topic-card {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 20px;
    text-align: center;
    }

    .topic-card h3 {
    font-size: 16px;
    margin-bottom: 8px;
    font-weight: 500;
    }

    .topic-duration {
    color: rgba(255, 255, 255, 0.7);
    font-size: 14px;
    margin-bottom: 15px;
    }

    .start-btn {
    background: rgba(255, 255, 255, 0.1);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 12px;
    cursor: pointer;
    }

    .start-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    }

    /* Recent Quizzes */
    .quiz-item {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 15px 20px;
    margin-bottom: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    }

    .quiz-info h4 {
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 4px;
    }

    .quiz-date {
    color: rgba(255, 255, 255, 0.7);
    font-size: 12px;
    }

    .quiz-actions {
    display: flex;
    gap: 10px;
    }

    .quiz-btn {
    padding: 6px 12px;
    border: none;
    border-radius: 4px;
    font-size: 12px;
    cursor: pointer;
    }

    .quiz-btn.review {
    background: rgba(74, 144, 226, 0.2);
    color: #4a90e2;
    border: 1px solid #4a90e2;
    }

    .quiz-btn.retake {
    background: rgba(255, 255, 255, 0.1);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Bottom Cards */
    .bottom-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
    }

    .info-card {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 20px;
    }

    .info-card h3 {
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
    }

    .info-card p {
    color: rgba(255, 255, 255, 0.8);
    font-size: 13px;
    line-height: 1.4;
    }

    /* Footer */
    .footer {
    text-align: center;
    padding: 30px 0;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    margin-top: 40px;
    }

    .footer h3 {
    font-size: 16px;
    margin-bottom: 15px;
    font-weight: 500;
    }

    .social-links {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-bottom: 20px;
    }

    .social-link {
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    color: white;
    transition: background 0.2s;
    }

    .social-link:hover {
    background: rgba(255, 255, 255, 0.2);
    }

    .footer-text {
    color: rgba(255, 255, 255, 0.7);
    font-size: 12px;
    line-height: 1.4;
    max-width: 600px;
    margin: 0 auto;
    }

    .copyright {
    margin-top: 15px;
    font-size: 12px;
    color: rgba(255, 255, 255, 0.6);
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {

    .sidebar {
    padding-top: 80px; /* More space on top for mobile so the X is accessible */
    }

    .mobile-header {
    display: flex;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 90px;
    background: rgba(15, 20, 25, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    z-index: 1100; /* Increased z-index */
    padding: 0 15px;
    padding-top: 30px;
    align-items: center;
    justify-content: space-between;
    }


    .container {
    flex-direction: column;
    }

    .sidebar {
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    z-index: 1000;
    transform: translateX(-100%);
    background: rgba(15, 20, 25, 0.98);
    backdrop-filter: blur(10px);
    margin-top: -45px;
    }

    .sidebar.active {
    transform: translateX(0);
    }

    .main-content {
    margin-top: 60px;
    padding: 20px 15px;
    }

    .header {
    display: none;
    }

    .welcome-title {
    font-size: 20px;
    }

    .welcome-buttons {
    flex-direction: column;
    }

    .btn {
    justify-content: center;
    }

    .progress-cards {
    grid-template-columns: 1fr;
    }

    .topics-grid {
    grid-template-columns: 1fr;
    }

    .quiz-item {
    flex-direction: column;
    gap: 10px;
    text-align: center;
    }

    .quiz-actions {
    justify-content: center;
    width: 100%;
    }

    .bottom-cards {
    grid-template-columns: 1fr;
    }

    .social-links {
    flex-wrap: wrap;
    }
    }

    @media (max-width: 480px) {
    .main-content {
    padding: 15px 10px;
    }

    .welcome-title {
    font-size: 18px;
    }

    .section-title {
    font-size: 16px;
    }

    .btn {
    padding: 10px 20px;
    font-size: 13px;
    }

    .user-dropdown {
    right: 10px;
    width: calc(100vw - 20px);
    margin-top: 30px;
    }
    }
    </style>

</head>
<body>
<!-- Mobile Header -->
<header class="mobile-header">
    <div class="mobile-burger" id="mobileMenu">
        <div class="burger-line"></div>
        <div class="burger-line"></div>
        <div class="burger-line"></div>
    </div>
    <div class="mobile-logo">
        <img src="photos/logo-icon.png" alt="Logo" class="icon" id="logo-icon">
        SyntaxSensei
    </div>
    <div class="mobile-user" id="mobileUser">
        <div class="mobile-user-avatar" id="mobileUserAvatar"></div>
        <span class="user-arrow">▼</span>
    </div>
</header>

<!-- Sidebar Overlay -->
<div class="sidebar-overlay" id="sidebarOverlay"></div>

<!-- User Dropdown -->
<div class="user-dropdown" id="userDropdown">
    <div class="user-info">
        <div class="avatar">
            <img src="/Photos/user-icon.png" alt="User" class="icon-large">
        </div>
        <h3>Pedro Dicamaal</h3>
        <p>pedrodicamaal@gmail.com</p>
    </div>
    <button class="dropdown-item">Change Account</button>
    <button class="dropdown-item" id="logoutBtn">Log Out Account</button>
</div>

<div class="container">
    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="logo">
            <img src="/Photos/logo-icon.png" alt="Logo" class="icon" id="logo-icon">
            SyntaxSensei
        </div>
        <div class="menu-item">
            <img src="/Photos/menu-icon.png" alt="Menu" class="icon">
            MENU ITEMS
        </div>
        <hr>
        <ul class="nav-menu">
            <li class="nav-item active">
                <img src="/Photos/home-icon.png" alt="Home" class="icon">
                Home
            </li>
            <li class="nav-item">
                <img src="/Photos/learning-page-icon.png" alt="Learning" class="icon">
                Learning Page
            </li>
            <li class="nav-item">
                <img src="/Photos/code-editor-icon.png" alt="Code" class="icon">
                Code Editor
            </li>
            <li class="nav-item">
                <img src="/Photos/library-icon.png" alt="Library" class="icon">
                Library
            </li>
            <li class="nav-item">
                <img src="/Photos/quiz-icon.png" alt="Exam" class="icon">
                Exam / Quizzes
            </li>
            <li class="nav-item">
                <img src="/Photos/setting-icon.png" alt="Settings" class="icon">
                Settings
            </li>
            <li class="nav-item">
                <img src="/Photos/contac-us-icon.png" alt="Contact" class="icon">
                Contact Us
            </li>
            <li class="nav-item">
                <img src="/Photos/about-us-icon.png" alt="About" class="icon">
                About Us
            </li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header (Desktop Only) -->
        <header class="header">
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Search...">
                <button class="search-btn">
                    <img src="Photos/search-icon.png" alt="Search" class="icon">
                </button>
            </div>
            <div class="user-menu" id="desktopUser">
                <div class="user-avatar" id="desktopUserAvatar"></div>
                <span class="user-arrow">▼</span>
            </div>
        </header>

        <!-- Welcome Section -->
        <section class="welcome-section">
            <h1 class="welcome-title">Welcome, Learners!<br>Ready to enhance your Java skills?</h1>
            <div class="welcome-buttons">
                <button class="btn btn-primary">Start New Session</button>
            </div>
        </section>

        <!-- Learning Progress -->
        <section class="section">
            <h2 class="section-title">Learning Progress</h2>
            <div class="progress-cards">
                <div class="progress-card">
                    <h3>Introduction to Java</h3>
                    <div class="progress-bar"><div class="progress-fill"></div></div>
                    <button class="continue-btn">➤ Continue Learning</button>
                </div>
                <div class="progress-card">
                    <h3>Creating Java programming</h3>
                    <div class="progress-bar"><div class="progress-fill"></div></div>
                    <button class="continue-btn">➤ Continue Learning</button>
                </div>
                <div class="progress-card">
                    <h3>Using Data</h3>
                    <div class="progress-bar"><div class="progress-fill"></div></div>
                    <button class="continue-btn">➤ Continue Learning</button>
                </div>
            </div>
        </section>

        <!-- Recommended Topics -->
        <section class="section">
            <h2 class="section-title">Recommended Topics</h2>
            <div class="topics-grid">
                <div class="topic-card">
                    <h3>Common Java Syntax Errors</h3>
                    <div class="topic-duration">5 minutes</div>
                    <button class="start-btn">Start Learning</button>
                </div>
                <div class="topic-card">
                    <h3>Object - Oriented Programming</h3>
                    <div class="topic-duration">15 minutes</div>
                    <button class="start-btn">Start Learning</button>
                </div>
                <div class="topic-card">
                    <h3>Exception Handling Basics</h3>
                    <div class="topic-duration">10 minutes</div>
                    <button class="start-btn">Start Learning</button>
                </div>
            </div>
        </section>

        <!-- Recent Activity -->
        <section class="section">
            <h2 class="section-title">Recent Activity</h2>
            <div class="quiz-item">
                <div class="quiz-info">
                    <h4>Creating Java Programs</h4>
                    <div class="quiz-date">Completed on Jan 18, 2025</div>
                </div>
                <div class="quiz-actions">
                    <button class="quiz-btn review">Review</button>
                    <button class="quiz-btn retake">Retake Quiz</button>
                </div>
            </div>
        </section>

        <!-- Bottom Info Cards -->
        <section class="bottom-cards">
            <div class="info-card">
                <h3><img src="/Photos/tip-of-the-day-icon.png" alt="Tip" class="icon">Tip of the Day</h3>
                <p>Always initialize your variables before using them to avoid NullPointerException.</p>
            </div>
            <div class="info-card">
                <h3><img src="/Photos/warning-icon.png" alt="Warning" class="icon">Common Mistake</h3>
                <p>Forgetting to close file streams can lead to memory leaks in your Java applications.</p>
            </div>
            <div class="info-card">
                <h3><img src="/Photos/clock-icon.png" alt="Time" class="icon">Time Spent Coding</h3>
                <p>You've spent 2 hours and 45 minutes coding this week. Keep up the great work!</p>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <h3>Follow us on:</h3>
            <div class="social-links">
                <a href="#" class="social-link"><img src="/Photos/fb-icon.png" alt="Facebook" class="social-icon"></a>
                <a href="#" class="social-link"><img src="Photos/insta-icon.png" alt="Instagram" class="social-icon"></a>
                <a href="#" class="social-link"><img src="Photos/x-icon.png" alt="Twitter" class="social-icon"></a>
                <a href="#" class="social-link"><img src="Photos/yt-icon.png" alt="YouTube" class="social-icon"></a>
            </div>
            <div class="footer-text">
                Our learning content is regularly refined, but we cannot ensure 100% accuracy. By using our platform, you agreed to have read and accepted our terms of use, cookie and privacy policy.
            </div>
            <div class="copyright">
                Copyright © 2025 SyntaxSensei. All rights reserved.<br>
                Built with love using modern web technologies.
            </div>
        </footer>
    </main>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyAzxnGO6zNDAVDMJ7VhCvNzzaSa36RJ5t4",
  authDomain: "syntaxsensei-99777.firebaseapp.com",
  projectId: "syntaxsensei-99777",
  storageBucket: "syntaxsensei-99777.appspot.com",
  messagingSenderId: "725585370674",
  appId: "1:725585370674:web:c340a8a5606baece47262b",
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Sidebar toggle
const mobileMenu = document.getElementById('mobileMenu');
const sidebar = document.getElementById('sidebar');
const sidebarOverlay = document.getElementById('sidebarOverlay');

function toggleSidebar() {
  mobileMenu.classList.toggle('active');
  sidebar.classList.toggle('active');
  sidebarOverlay.classList.toggle('active');
  document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : '';
}

mobileMenu?.addEventListener('click', toggleSidebar);
sidebarOverlay?.addEventListener('click', toggleSidebar);

// Dropdown toggle (mobile)
const mobileUser = document.getElementById('mobileUser');
const userDropdown = document.getElementById('userDropdown');
const userArrow = mobileUser?.querySelector('.user-arrow');

function toggleUserDropdown() {
  userDropdown.classList.toggle('active');
  userArrow?.classList.toggle('active');
}
mobileUser?.addEventListener('click', toggleUserDropdown);

// Dropdown toggle (desktop)
const desktopUser = document.getElementById('desktopUser');
const desktopArrow = desktopUser?.querySelector('.user-arrow');

desktopUser?.addEventListener('click', () => {
  userDropdown.classList.toggle('active');
  desktopUser.classList.toggle('active');
});

// Close dropdowns on outside click
document.addEventListener('click', (event) => {
  if (
    !mobileUser?.contains(event.target) &&
    !userDropdown.contains(event.target) &&
    (!desktopUser || !desktopUser.contains(event.target))
  ) {
    userDropdown.classList.remove('active');
    userArrow?.classList.remove('active');
    desktopUser?.classList.remove('active');
  }
});

// Sidebar item active
const navItems = document.querySelectorAll('.nav-item');
navItems.forEach(item => {
  item.addEventListener('click', () => {
    if (window.innerWidth <= 768) toggleSidebar();
    navItems.forEach(nav => nav.classList.remove('active'));
    item.classList.add('active');
  });
});

// Reset sidebar on window resize
window.addEventListener('resize', () => {
  if (window.innerWidth > 768) {
    sidebar.classList.remove('active');
    sidebarOverlay.classList.remove('active');
    mobileMenu.classList.remove('active');
    document.body.style.overflow = '';
  }
});

// Logout
const logoutBtn = document.getElementById('logoutBtn');
logoutBtn?.addEventListener('click', () => {
  signOut(auth)
    .then(() => window.location.href = 'index.html')
    .catch((error) => {
      alert("Failed to log out. Please try again.");
      console.error("Logout error:", error);
    });
});

// Dropdown user info fields
const userNameField = document.querySelector('.user-info h3');
const userEmailField = document.querySelector('.user-info p');
const avatarImage = document.querySelector('.user-info .avatar img');
const avatarCircle = document.querySelector('.user-info .avatar');
const avatarInitial = document.createElement('div');
avatarInitial.className = 'avatar-initial';
avatarInitial.style.display = 'none';

// Header avatars (mobile and desktop)
const mobileAvatarContainer = document.getElementById('mobileUserAvatar');
const desktopAvatarContainer = document.getElementById('desktopUserAvatar');

// Function to generate avatar element
function createAvatarElement(initial, photoURL) {
  const wrapper = document.createElement('div');
  wrapper.className = 'avatar-small';

  if (photoURL) {
    const img = document.createElement('img');
    img.src = photoURL;
    img.alt = 'User';
    img.className = 'icon-small';
    wrapper.appendChild(img);
  } else {
    const initialDiv = document.createElement('div');
    initialDiv.className = 'avatar-initial-small';
    initialDiv.textContent = initial;
    wrapper.appendChild(initialDiv);
  }

  return wrapper;
}

// Load user data
onAuthStateChanged(auth, async (user) => {
  if (user) {
    try {
      const docRef = doc(db, "users", user.uid);
      const docSnap = await getDoc(docRef);

      const displayName = docSnap.exists() ? docSnap.data().name || "User" : "User";
      const email = user.email;
      const photoURL = user.photoURL;
      const initial = displayName[0].toUpperCase();

      // Update dropdown
      userNameField.textContent = displayName;
      userEmailField.textContent = email;

      if (photoURL) {
        avatarImage.src = photoURL;
        avatarImage.style.display = 'block';
        if (avatarCircle.contains(avatarInitial)) avatarCircle.removeChild(avatarInitial);
      } else {
        avatarImage.style.display = 'none';
        avatarInitial.textContent = initial;
        avatarCircle.appendChild(avatarInitial);
        avatarInitial.style.display = 'flex';
      }

      // Update mobile and desktop headers
      mobileAvatarContainer.innerHTML = '';
      desktopAvatarContainer.innerHTML = '';
      mobileAvatarContainer.appendChild(createAvatarElement(initial, photoURL));
      desktopAvatarContainer.appendChild(createAvatarElement(initial, photoURL));
    } catch (error) {
      console.error("Error loading user info:", error);
    }
  } else {
    window.location.href = "index.html";
  }
});
</script>
</body>
</html>